{"version":3,"sources":["SocketContext.js","components/VideoGrid.js","components/Layout.js","App.js","index.js","styles/layout.module.css","styles/components.module.css"],"names":["SocketContext","createContext","socket","io","process","ContextProvider","children","useState","stream","setStream","me","setMe","call","setCall","callAccepted","setCallAccepted","callEnded","setCallEnded","name","setName","myVideo","useRef","userVideo","connectionRef","useEffect","navigator","mediaDevices","getUserMedia","video","audio","then","currentStream","current","srcObject","on","id","from","callerName","signal","isReceivedCall","Provider","value","callUser","peer","Peer","initiator","trickle","data","emit","userToCall","signalData","leaveCall","destroy","window","location","reload","answerCall","to","VideoGrid","useContext","className","styles","mainDiv","videoGridItem","playsInline","muted","ref","autoPlay","Layout","idToCall","setIdToCall","Styles","bgContainer","onClick","headerIconContainer","footerContainer","inputDiv","type","placeholder","onChange","e","target","footerIcon","clipboard","writeText","size","bgGreen","bgRed","App","ReactDOM","render","StrictMode","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.e2243435.chunk.js","sourcesContent":["import React, { createContext, useState, useRef, useEffect } from 'react';\nimport { io } from 'socket.io-client';\nimport Peer from 'simple-peer';\n\nconst SocketContext = createContext();\n\nconst socket = io((process.env.NODE_ENV === 'development') ? process.env.REACT_APP_LOCAL_SERVER_URI : process.env.REACT_APP_PRODUCTION_SERVER_URI);\n\n// const socket = io('https://praneeth-video-call.glitch.me/');\n\nconst ContextProvider = ({ children }) => {\n    const [stream, setStream] = useState(null);\n    const [me, setMe] = useState('');\n    const [call, setCall] = useState({});\n    const [callAccepted, setCallAccepted] = useState(false);\n    const [callEnded, setCallEnded] = useState(false);\n    const [name, setName] = useState('');\n\n    const myVideo = useRef();\n    const userVideo = useRef();\n    const connectionRef = useRef();\n\n    useEffect(() => {\n        navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n            .then((currentStream) => {\n                setStream(currentStream);\n\n                myVideo.current.srcObject = currentStream;\n            });\n\n        socket.on('me', (id) => setMe(id));\n        socket.on('calluser', ({ from, name: callerName, signal }) => {\n            setCall({ isReceivedCall: true, from, name: callerName, signal })\n        });\n    }, []);\n\n    const answerCall = () => {\n        setCallAccepted(true);\n\n        const peer = new Peer({ initiator: false, trickle: false, stream });\n\n        peer.on('signal', (data) => {\n            socket.emit('answercall', { signal: data, to: call.from })\n        });\n\n        peer.on('stream', (currentStream) => {\n            userVideo.current.srcObject = currentStream;\n        });\n\n        peer.signal(call.signal);\n\n        connectionRef.current = peer;\n    };\n\n    const callUser = (id) => {\n        const peer = new Peer({ initiator: true, trickle: false, stream });\n\n        peer.on('signal', (data) => {\n            socket.emit('calluser', { userToCall: id, signalData: data, from: me, name })\n        });\n\n        peer.on('stream', (currentStream) => {\n            userVideo.current.srcObject = currentStream;\n        });\n\n        socket.on('callaccepted', (signal) => {\n            setCallAccepted(true);\n\n            peer.signal(signal);\n        });\n\n        connectionRef.current = peer;\n    };\n\n    const leaveCall = () => {\n        setCallEnded(true);\n\n        connectionRef.current.destroy();\n\n        window.location.reload();\n    };\n\n    return (\n        <SocketContext.Provider value={{ call, callAccepted, myVideo, userVideo, stream, name, setName, callEnded, me, callUser, leaveCall, answerCall }}>\n            { children}\n        </SocketContext.Provider>\n    )\n}\n\nexport { ContextProvider, SocketContext };","import React, { useContext } from 'react'\nimport styles from '../styles/components.module.css';\n\nimport { SocketContext } from '../SocketContext';\n\n\nfunction VideoGrid() {\n    const { name, callAccepted, myVideo, userVideo, callEnded, stream, call } = useContext(SocketContext);\n    return (\n        <div className={styles.mainDiv}>\n            {\n                stream && (\n                    <div className={styles.videoGridItem} >\n                        <h1>{name || 'Me'}</h1>\n                        <video playsInline muted ref={myVideo} autoPlay></video>\n                    </div>\n                )\n            }\n            {\n                callAccepted && !callEnded && (\n                    <div className={styles.videoGridItem} >\n                        <h1>{call.name || 'Name'}</h1>\n                        <video playsInline ref={userVideo} autoPlay></video>\n                    </div>\n                )\n            }\n            {/* <div className=\"videoGrid\" ></div>\n            <div className=\"videoGrid\" ></div>\n            <div className=\"videoGrid\" ></div>\n            <div className=\"videoGrid\" ></div> */}\n        </div>\n\n    )\n}\n\nexport default VideoGrid;\n","import React, { useState, useContext } from 'react';\nimport { FaUser, FaVideo, FaMicrophone, FaPhone, FaEllipsisV, FaClone } from 'react-icons/fa';\n\nimport Styles from '../styles/layout.module.css';\n\nimport { SocketContext } from '../SocketContext';\n\n\nfunction Layout({ children }) {\n    const { me, myVideo, callAccepted, name, setName, callEnded, leaveCall, callUser, userVideo, answerCall, call } = useContext(SocketContext);\n    const [idToCall, setIdToCall] = useState('');\n\n    return (\n        <div className={Styles.bgContainer}>\n            <header>\n                <h1>Call Me</h1>\n                {call.isReceivedCall && !callAccepted && (\n                    <div>\n                        {call.name} is callng:\n                        <button onClick={answerCall}>Answer</button>\n                    </div>\n                )}\n                <div className={Styles.headerIconContainer}>\n                    <FaUser />\n                </div>\n            </header>\n            { children}\n            <div className={Styles.footerContainer}>\n                <div className={Styles.inputDiv}>\n                    <input type=\"text\" placeholder=\"Your Name\" value={name} onChange={(e) => setName(e.target.value)} />\n                    <span className={Styles.footerIcon} onClick={() => navigator.clipboard.writeText(me)}><FaClone size={12} /></span>\n                </div>\n\n                {!(callAccepted && !callEnded) ? (\n                    <div className={Styles.inputDiv}>\n                        <input type=\"text\" placeholder=\"ID to call\" value={idToCall} onChange={(e) => setIdToCall(e.target.value)} />\n                        <span className={Styles.bgGreen + ' ' + Styles.footerIcon} onClick={() => callUser(idToCall)}><FaPhone size={12} /></span>\n                    </div>\n                ) : ('')}\n\n\n                <footer>\n                    <div className={Styles.footerIcon} onClick={() => {}}><FaVideo /></div>\n                    <div className={Styles.footerIcon} onClick={() => {}}><FaMicrophone /></div>\n                    {callAccepted && !callEnded ? (\n                        <div className={Styles.bgRed + ' ' + Styles.footerIcon} onClick={leaveCall}><FaPhone /></div>\n                    ) : ('')}\n                    <div className={Styles.footerIcon}><FaEllipsisV /></div>\n                </footer>\n            </div>\n\n        </div>\n    )\n}\n\nexport default Layout;\n","// import logo from './logo.svg';\nimport VideoGrid from './components/VideoGrid.js';\nimport Layout from './components/Layout.js';\n\nfunction App() {\n  return (\n    <Layout>\n      <VideoGrid />\n    </Layout>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/styles.css';\nimport App from './App';\n\nimport { ContextProvider } from './SocketContext';\n\nReactDOM.render(\n  <React.StrictMode>\n    <ContextProvider>\n      <App />\n    </ContextProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bgContainer\":\"layout_bgContainer__2rEjF\",\"headerIconContainer\":\"layout_headerIconContainer__2ggJE\",\"footerContainer\":\"layout_footerContainer__1Zzin\",\"footerIcon\":\"layout_footerIcon__3S4aO\",\"inputDiv\":\"layout_inputDiv__1S32Y\",\"bgRed\":\"layout_bgRed__erId6\",\"bgGreen\":\"layout_bgGreen__3K5vh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainDiv\":\"components_mainDiv__1ShOV\",\"videoGridItem\":\"components_videoGridItem__2zBQu\"};"],"sourceRoot":""}